{"openapi":"3.0.1","info":{"title":"Create and Vary a Licence Public API","description":"API for access to licence data.\n\nPlease note:\n  - Edits of approved licences (pre-release) or variations of licence (post-release) create new licence records within the database. \n  Previously-approved and pre-variation licence records can still be found if they have not been made INACTIVE. If historic INACTIVE \n  licence information is required, please contact the CVL team.\n  - In flight licences are those that have a non-INACTIVE status code. This represents licences that are either ACTIVE or \n  have the potential to become ACTIVE, and includes the following status codes:\n    - [ACTIVE, IN_PROGRESS, SUBMITTED, APPROVED, VARIATION_IN_PROGRESS, VARIATION_SUBMITTED, VARIATION_APPROVED & VARIATION_REJECTED]\n  - Condition data is different dependent on the type of condition:\n    - Standard conditions have static text\n    - Additional conditions may be static text or have a combination of static and inputted text\n    - Bespoke conditions are purely inputted text\n  - The list of status codes currently used by CVL is subject to change as new features may require additional codes to be added.","contact":{"name":"HMPPS Digital Studio","email":"feedback@digital.justice.gov.uk"},"version":"2024-01-23.9813.7cefc95"},"servers":[{"url":"https://create-and-vary-a-licence-api-dev.hmpps.service.justice.gov.uk","description":"Generated server url"}],"paths":{"/public/policy/{version}":{"get":{"tags":["Licence Policy"],"summary":"Get a policy by its version number","description":"Returns a policy by its version number. Requires ROLE_VIEW_LICENCES.","operationId":"getPolicyByVersionNumber","parameters":[{"name":"version","in":"path","description":"The version of the licence policy","required":true,"schema":{"type":"string"},"example":2.1}],"responses":{"404":{"description":"The policy for this version was not found.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Policy found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LicencePolicy"}}}},"401":{"description":"Unauthorised, requires a valid Oauth2 token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Forbidden, requires an appropriate role","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"ROLE_VIEW_LICENCES":[]}]}},"/public/policy/latest":{"get":{"tags":["Licence Policy"],"summary":"Get latest policy.","description":"Returns latest policy. Requires ROLE_VIEW_LICENCES.","operationId":"getLatestPolicy","responses":{"403":{"description":"Forbidden, requires an appropriate role.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Policy found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LicencePolicy"}}}},"401":{"description":"Unauthorised, requires a valid Oauth2 token.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"ROLE_VIEW_LICENCES":[]}]}},"/public/licences/{licenceId}/conditions/{conditionId}/image-upload":{"get":{"tags":["Licences"],"summary":"Get an associated image upload for a specific licence and condition","description":"Returns an associated image upload for a specified licence and condition. Requires ROLE_VIEW_LICENCES.","operationId":"getImageUpload","parameters":[{"name":"licenceId","in":"path","description":"This is the identifier for a licence","required":true,"schema":{"type":"integer","format":"int64"}},{"name":"conditionId","in":"path","description":"This is the internal identifier for a condition","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"404":{"description":"No image was found.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Image returned","content":{"image/jpeg":{}}},"401":{"description":"Unauthorised, requires a valid Oauth2 token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Forbidden, requires an appropriate role","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"ROLE_VIEW_LICENCES":[]}]}},"/public/licences/id/{licenceId}":{"get":{"tags":["Licences"],"summary":"Get a licence by its licence id","description":"Returns a single licence detail by its unique identifier. Requires ROLE_VIEW_LICENCES.","operationId":"getLicenceById","parameters":[{"name":"licenceId","in":"path","description":"This is the identifier for a licence","required":true,"schema":{"minimum":1,"type":"integer","format":"int64"}}],"responses":{"200":{"description":"Licence found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Licence"}}}},"404":{"description":"The licence for this ID was not found.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Unauthorised, requires a valid Oauth2 token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Forbidden, requires an appropriate role","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"ROLE_VIEW_LICENCES":[]}]}},"/public/licence-summaries/prison-number/{prisonNumber}":{"get":{"tags":["Licences"],"summary":"Get a list of in flight licences by prison number","description":"Returns a list of licence summaries by a person's prison number. Requires ROLE_VIEW_LICENCES.","operationId":"getLicencesByPrisonNumber","parameters":[{"name":"prisonNumber","in":"path","description":"The prison identifier for the person on the licence (also known as NOMS id)","required":true,"schema":{"type":"string"},"example":"A1234BC"}],"responses":{"200":{"description":"A list of found licence summaries","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/LicenceSummary"}}}}},"401":{"description":"Unauthorised, requires a valid Oauth2 token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Forbidden, requires an appropriate role","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"ROLE_VIEW_LICENCES":[]}]}},"/public/licence-summaries/crn/{crn}":{"get":{"tags":["Licences"],"summary":"Get a list of in flight licences by CRN","description":"Returns a list of licence summaries by a person's CRN. Requires ROLE_VIEW_LICENCES.","operationId":"getLicenceByCrn","parameters":[{"name":"crn","in":"path","description":"The case reference number (CRN) for the person on the licence","required":true,"schema":{"type":"string"},"example":"A123456"}],"responses":{"200":{"description":"A list of found licence summaries","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/LicenceSummary"}}}}},"401":{"description":"Unauthorised, requires a valid Oauth2 token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Forbidden, requires an appropriate role","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"ROLE_VIEW_LICENCES":[]}]}}},"components":{"schemas":{"ErrorResponse":{"required":["status"],"type":"object","properties":{"status":{"type":"integer","format":"int32"},"errorCode":{"type":"integer","format":"int32"},"userMessage":{"type":"string"},"developerMessage":{"type":"string"},"moreInfo":{"type":"string"}}},"ConditionTypes":{"required":["AP","PSS"],"type":"object","properties":{"AP":{"$ref":"#/components/schemas/LicencePolicyConditions"},"PSS":{"$ref":"#/components/schemas/LicencePolicyConditions"}},"description":"The type of conditions on a licence policy which can be AP (All Purpose) and/or PSS (Post Sentence Supervision)"},"LicencePolicy":{"required":["conditions","version"],"type":"object","properties":{"version":{"type":"string","description":"The version of the licence policy","example":"V2_1","enum":["V1_0","V2_0","V2_1"]},"conditions":{"$ref":"#/components/schemas/ConditionTypes"}},"description":"Describes the set of conditions associated with a given version of the policy"},"LicencePolicyAdditionalCondition":{"required":["category","code","requiresUserInput","text"],"type":"object","properties":{"code":{"type":"string","description":"The additional condition's unique code","example":"5a105297-dce1-4d18-b9ea-4195b46b7594"},"text":{"type":"string","description":"The additional condition","example":"Test condition"},"category":{"type":"string","description":"The category to which the additional condition belongs","example":"Residence at a specific place"},"categoryShort":{"type":"string","description":"The shorthand version of the category to which the additional condition belongs","example":"Residence"},"requiresUserInput":{"type":"boolean","description":"Indicates whether the condition requires any user input","example":true}},"description":"Describes each additional condition on the licence policy"},"LicencePolicyConditions":{"required":["additional","standard"],"type":"object","properties":{"standard":{"type":"array","description":"The list of standard conditions which form the licence policy","items":{"$ref":"#/components/schemas/StandardCondition"}},"additional":{"type":"array","description":"The list of additional conditions which form the licence policy","items":{"$ref":"#/components/schemas/LicencePolicyAdditionalCondition"}}},"description":"Describes the conditions which form a licence policy"},"StandardCondition":{"required":["code","text"],"type":"object","properties":{"code":{"type":"string","description":"The code shared by all instances of this condition","example":"5a105297-dce1-4d18-b9ea-4195b46b7594"},"text":{"type":"string","description":"The standard condition","example":"Not commit any offence."}},"description":"Describes each standard condition"},"AdditionalCondition":{"required":["category","code","id","text","type"],"type":"object","properties":{"id":{"type":"integer","description":"The ID of this condition instance","format":"int64","example":123456},"type":{"type":"string","description":"Discriminator for condition type","example":"STANDARD"},"text":{"type":"string","description":"The inputted text for the instance","example":"You must not enter the location X"},"code":{"type":"string","description":"The code shared by all conditions of this type","example":"5a105297-dce1-4d18-b9ea-4195b46b7594"},"category":{"type":"string","description":"The category to which the additional condition belongs","example":"Residence at a specific place"}},"description":"Describes each additional condition on the licence, A discriminator exists to allow specific types of conditions to contain additional info","discriminator":{"propertyName":"type","mapping":{"STANDARD":"#/components/schemas/GenericAdditionalCondition","ELECTRONIC_MONITORING":"#/components/schemas/ElectronicMonitoringAdditionalConditionWithRestriction","MULTIPLE_EXCLUSION_ZONE":"#/components/schemas/ExclusionZoneAdditionalCondition"}}},"ApConditions":{"required":["additional","bespoke","standard"],"type":"object","properties":{"standard":{"type":"array","description":"The list of standard conditions which form the licence","items":{"$ref":"#/components/schemas/StandardCondition"}},"additional":{"type":"array","description":"The list of additional conditions which form the licence","items":{"$ref":"#/components/schemas/AdditionalCondition"}},"bespoke":{"type":"array","description":"The list of bespoke conditions which form the licence","items":{"$ref":"#/components/schemas/BespokeCondition"}}},"description":"Describes the All Purpose conditions which apply to a licence"},"BespokeCondition":{"required":["text"],"type":"object","properties":{"text":{"type":"string","description":"The user input for the bespoke condition","example":"You should not visit Y"}},"description":"Describes each bespoke condition on the licence"},"Conditions":{"required":["AP","PSS"],"type":"object","properties":{"AP":{"$ref":"#/components/schemas/ApConditions"},"PSS":{"$ref":"#/components/schemas/PssConditions"}},"description":"The type of conditions on a licence which can be AP (All Purpose) and/or PSS (Post Sentence Supervision)"},"ElectronicMonitoringAdditionalConditionWithRestriction":{"required":["category","code","id","restrictions","text","type"],"type":"object","properties":{"id":{"type":"integer","description":"The ID of this condition instance","format":"int64","example":123456},"category":{"type":"string","description":"The category to which the additional condition belongs","example":"Electronic monitoring"},"type":{"type":"string","description":"Discriminator for condition type","example":"ELECTRONIC_MONITORING"},"code":{"type":"string","description":"The code shared by all conditions of this type","example":"fd129172-bdd3-4d97-a4a0-efd7b47a49d4"},"text":{"type":"string","description":"The inputted text for the instance","example":"Allow person(s) as designated by your supervising officer to install an electronic monitoring tag on you and access to install any associated equipment in your property, and for the purpose of ensuring that equipment is functioning correctly. You must not damage or tamper with these devices and ensure that the tag is charged, and report to your supervising officer and the EM provider immediately if the tag or the associated equipment are not working correctly. This will be for the purpose of monitoring your ALCOHOL licence condition(s) unless otherwise authorised by your supervising officer."},"restrictions":{"type":"string","description":"The type of electronic monitoring that is included by this condition","example":"['ALCOHOL']","enum":["EXCLUSION_ZONE","CURFEW","LOCATION_MONITORING","ATTENDANCE_AT_APPOINTMENTS","ALCOHOL_MONITORING","ALCOHOL_ABSTINENCE"]}},"description":"Describes an instance of the electronic monitoring condition on the licence"},"ExclusionZoneAdditionalCondition":{"required":["category","code","hasImageUpload","id","text","type"],"type":"object","properties":{"id":{"type":"integer","description":"The ID of this condition instance","format":"int64","example":123456},"category":{"type":"string","description":"The category to which the additional condition belongs","example":"Freedom of movement"},"type":{"type":"string","description":"Discriminator for condition type","example":"MULTIPLE_EXCLUSION_ZONE"},"code":{"type":"string","description":"The code shared by all conditions of this type","example":"0f9a20f4-35c7-4c77-8af8-f200f153fa11"},"text":{"type":"string","description":"The inputted text for the instance","example":"Not to enter the area of X, as defined by the attached map, without the prior approval of your supervising officer."},"hasImageUpload":{"type":"boolean","description":"Whether any image was uploaded when the instance was created","example":true}},"description":"Describes an instance of the multiple exclusion zone condition on the licence"},"GenericAdditionalCondition":{"required":["category","code","id","text","type"],"type":"object","properties":{"id":{"type":"integer","description":"The ID of this condition instance","format":"int64","example":123456},"category":{"type":"string","description":"The category to which the additional condition belongs","example":"Residence at a specific place"},"type":{"type":"string","description":"Discriminator for condition type","example":"STANDARD"},"code":{"type":"string","description":"The code shared by all conditions of this type","example":"5a105297-dce1-4d18-b9ea-4195b46b7594"},"text":{"type":"string","description":"A combination of inputted text and template text including any user input","example":"You must not enter the location X"}},"description":"Describes an instance of a additional condition on the licence"},"Licence":{"required":["bookingId","conditions","createdByUsername","createdDateTime","crn","id","isInPssPeriod","licenceType","policyVersion","prisonNumber","statusCode","version"],"type":"object","properties":{"id":{"type":"integer","description":"Unique identifier for this licence within the service","format":"int64","example":99999},"licenceType":{"type":"string","description":"The licence type","example":"AP","enum":["AP","PSS","AP_PSS"]},"policyVersion":{"type":"string","description":"The policy version number the licence is currently on","example":"V2_1","enum":["V1_0","V2_0","V2_1"]},"version":{"type":"string","description":"The version of this specific licence, this is unique within the context of a booking","example":"1.4"},"statusCode":{"type":"string","description":"The current status code for the licence. This is non exhaustive and subject to change","example":"IN_PROGRESS","enum":["IN_PROGRESS","SUBMITTED","APPROVED","ACTIVE","VARIATION_IN_PROGRESS","VARIATION_SUBMITTED","VARIATION_APPROVED","VARIATION_REJECTED"]},"prisonNumber":{"type":"string","description":"The prison identifier for the person on the licence. Also known as the NOMIS ID","example":"A1234AA"},"bookingId":{"type":"integer","description":"The prison internal booking ID for the person on the licence","format":"int64","example":989898},"crn":{"type":"string","description":"The Delius case reference number (CRN) for the person on the licence","example":"X12444"},"approvedByUsername":{"type":"string","description":"The username of the person who approved the licence (PDU head or governor)","example":"X33221"},"approvedDateTime":{"type":"string","description":"The date and time that the prison approved the licence, where licences approved before 01/04/2023 will not have an approved time","format":"date-time","example":"2023-11-20T00:00:00Z"},"createdByUsername":{"type":"string","description":"The username of the person who created the licence","example":"X12333"},"createdDateTime":{"type":"string","description":"The date and time when the version/variation of the licence was created at","format":"date-time","example":"2023-11-20T00:00:00Z"},"updatedByUsername":{"type":"string","description":"The username of the person who last updated the licence","example":"X34433"},"updatedDateTime":{"type":"string","description":"The date and time that the licence was last updated","format":"date-time"},"isInPssPeriod":{"type":"boolean","description":"Whether the licence in PSS period? This is when Licence End Date < TODAY <= TUSED (Top Up Supervision End Date)"},"conditions":{"$ref":"#/components/schemas/Conditions"}},"description":"Describes a licence within this service"},"PssConditions":{"required":["additional","standard"],"type":"object","properties":{"standard":{"type":"array","description":"The list of standard conditions which form the licence","items":{"$ref":"#/components/schemas/StandardCondition"}},"additional":{"type":"array","description":"The list of additional conditions which form the licence","items":{"$ref":"#/components/schemas/AdditionalCondition"}}},"description":"Describes the Post Sentence Supervision conditions which apply to a licence"},"LicenceSummary":{"required":["bookingId","createdByUsername","createdDateTime","crn","id","isInPssPeriod","licenceType","policyVersion","prisonNumber","statusCode","version"],"type":"object","properties":{"id":{"type":"integer","description":"Unique identifier for this licence within the service","format":"int64","example":99999},"licenceType":{"type":"string","description":"The type of conditions on a licence policy which can be AP (All Purpose) and/or PSS (Post Sentence Supervision)","example":"AP","enum":["AP","PSS","AP_PSS"]},"policyVersion":{"type":"string","description":"The policy version number the licence is currently on","example":"V2_1","enum":["V1_0","V2_0","V2_1"]},"version":{"type":"string","description":"The version of this specific licence, this is unique within the context of a booking","example":"1.4"},"statusCode":{"type":"string","description":"The current status code for the licence. This is non exhaustive and subject to change","example":"IN_PROGRESS","enum":["IN_PROGRESS","SUBMITTED","APPROVED","ACTIVE","VARIATION_IN_PROGRESS","VARIATION_SUBMITTED","VARIATION_APPROVED","VARIATION_REJECTED"]},"prisonNumber":{"type":"string","description":"The prison identifier for the person on the licence. Also known as the NOMIS ID","example":"A1234AA"},"bookingId":{"type":"integer","description":"The prison internal booking ID for the person on the licence","format":"int64","example":989898},"crn":{"type":"string","description":"The Delius case reference number (CRN) for the person on the licence","example":"X12444"},"approvedByUsername":{"type":"string","description":"The username of the person who approved the licence (PDU head or governor)","example":"X33221"},"approvedDateTime":{"type":"string","description":"The date and time that the prison approved the licence, where licences approved before 01/04/2023 will not have an approved time","format":"date-time","example":"2023-11-20T00:00:00Z"},"createdByUsername":{"type":"string","description":"The username of the person who created the licence","example":"X12333"},"createdDateTime":{"type":"string","description":"The date and time when the version/variation of the licence was created at","format":"date-time","example":"2023-11-20T00:00:00Z"},"updatedByUsername":{"type":"string","description":"The username of the person who last updated the licence","example":"X34433"},"updatedDateTime":{"type":"string","description":"The date and time that the licence was last updated","format":"date-time","example":"2023-11-20T00:00:00Z"},"isInPssPeriod":{"type":"boolean","description":"Whether the licence in PSS period? This is when Licence End Date < TODAY <= TUSED (Top Up Supervision End Date)"}},"description":"Describes a licence summary within this service"}}}}